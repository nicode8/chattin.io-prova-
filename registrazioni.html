<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrazioni</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8088869830901654"
     crossorigin="anonymous"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VZVJ7VC46R"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VZVJ7VC46R');
    
</script>
<style>
body{
    background-color: #e0e0e0;
    height:100vh;
    display:flex;
    justify-content: center;
    font-family: 'Inter', sans-serif;
    overflow-y: hidden;

}

#container{
    background-color: #ffffff;
    margin-top:8vh;
    padding-top:5vh;
    width:60vh;
    height: 80vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-left:5vh;
    padding-right:5vh;
    border: none;
}
h1{
    color:#2563EB;
    font-size: 4vh;
}

#container-body{
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 5vh;

}

.input{
    width: 40vh;
    height: 5vh;
    font-size: 2vh;
    padding-left:1vh;
    border-top:none;
    border-left:none;
    border-right:none;
    border-bottom:1px solid black;
    margin-bottom: 4vh;
    padding-top:1vh;
}
.input + #hideShow{
    margin-left:1vh;
}
#pass_btn{
    display: flex;
    justify-content: center;
    position:relative;
    display: inline-block;
    padding-bottom:0vh;
    margin-bottom: -4vh;
}
#hideShow{
    width:5vh;
    position: absolute;
}

.red_response{
    
    color:red;
    margin-top:-1vh;
    font-size: 2vh;
    text-align: center;
    height:1vh;
    width:100%;
    font-size:1.5vh;
    margin-bottom:1vh;
}
#submitt{

    margin-top:12vh;
    width:20vh;
    height: 6vh;


}

#sbmt{
    font-size: 3vh;
    background-color:#2563EB ; 
    color:white;
    border-radius: 15px;
    border: none;
    width: 100%;
    height: 100%;
}







@media screen and (max-width:767px)
{
    body{
        background-color: #ffffff;
        overflow-Y: hidden;
        position: fixed;
    }
    #container{
        margin-top:0;
        height:100vh;
        width: 100%;
        padding-left: 2vh;
        
        
        
    }
    h1{
        font-size:6vh;
        padding-left: 3vh;
        padding-left: 3vh;
    }
    .input{
        width:70vw;
    }
    #submitt{
    width: 100%;;
    height: 8vh;
    display: flex;
    justify-content: center;justify-content: center;

    }
    
    #sbmt{
        font-size: 4vh;
        width:25vh;
    }
}
</style>
</head>
<body>

<form action="registrazioni.php" method="POST">
    <fieldset id="container">
        <h1>Sign Up</h1>
        <div id="container-body">
            <div>
            <input type="text"  class="input" id="nome" name="nome" value="" placeholder=" Inserisci nome" size="15">
            </div>

            <div>
            <input type="text"  class="input" id="username" name="username" value="" placeholder=" Inserisci username" size="15">
            </div>

            <div>
            <input type="text"  class="input" id="email" name="email" value="" placeholder=" Inserire e-mail" size="15">
            </div>

            <div id="pass_btn">
                <input type="password" class="input" id="passw" name="passw" value="" placeholder=" Inserire password" size="15">
                <img src="open_eye.png" id="hideShow">
                   
            </div>
            
        </div>
        <div id="submitt">
            <input type="button" id="sbmt" name="sbmt" value="Registrati" onClick="sign_up();">
            

        </div>
        
    </fieldset>
</form>




<script type="text/javascript">

    hideShow.addEventListener("click",mostrapass)
    var testo_password=document.getElementById("passw");
    var email=document.getElementById("email");
    var username=document.getElementById("username");
    var nome=document.getElementById("nome");
    testo_password.addEventListener('focus',function(){clean_message("redMessage_password");});
    email.addEventListener('focus',function(){clean_message("redMessage_email");});
    username.addEventListener('focus',function(){clean_message("redMessage_username");});
    nome.addEventListener('focus',function(){clean_message("redMessage_nome");});

    function mostrapass()
    {   
        
        var input=document.getElementById("passw"),text;
        text=document.getElementById("hideShow");
        if(input.type=="password")
            {
                input.type="text";
                text.src= "closed_eye.png";

            }   


        else
            {
                input.type="password";
                text.src="open_eye.png";
            }

    }


    function sign_up(){
        var dati={
        nome:document.getElementById("nome").value,
        username:document.getElementById("username").value,
        email:document.getElementById("email").value,
        passw:document.getElementById("passw").value,
        }
        
        var regex_email= /^[a-z][a-z0-9\.]+@[^\s@]+\.[a-z]+$/;
        var regex_password= /^(?=.*[A-Za-z0-9])+(?=.*[!\.()\\/])+[A-Za-z0-9!\.()\\/]+$/;
        var regex_username= /^[A-Za-z][A-Za-z0-9]+$/;
        var regex_nome= /^[A-Za-z]+$/;

        if((!regex_nome.test(nome.value))||(nome.value.length<3))
            controllo_red_message(nome,"red_response","redMessage_nome","Inserire nome","Inserire nome valido");

        if((!regex_username.test(username.value)))
            controllo_red_message(username,"red_response","redMessage_username","Inserire username","Inserire username valida");    

        if(!regex_email.test(email.value))
            controllo_red_message(email,"red_response","redMessage_email","Inserire email","Inserire email valida");
    

        if(testo_password.value.length<8)
            controllo_red_message(passw,"red_response","redMessage_password","Inserire password","La password deve:\n\n- avere almeno 8 caratteri\n- contenere almeno un carattere tra: ! . ( ) \ / ");

        if(!regex_password.test(testo_password.value))
            controllo_red_message(passw,"red_response","redMessage_password","Inserire password","password non accettabile");


        

        
        





        fetch("http://localhost:8080/chattin.iox/registrazioni.php",
        {
            method:"POST",
            headers:{"Content-type":"application/json"},
            body: JSON.stringify(dati)
        })
        .then(response=> response.json())
        .then(errore=> alert(errore));

    }

    
    function controllo_red_message(input,class_name,id_name,text_null,text){
        var id=document.getElementById(id_name);
        
        if((!input.value)&&(!id))
         {   fun_red_message(input,class_name,id_name,text_null);
            console.log("ciao");
         }
        else
        {   if((input.value)&&(!id))
                fun_red_message(input,class_name,id_name,text);
                
        }
    }

    function fun_red_message(input,class_name,id_name,text){
        
        var item=document.createElement("div");
        item.classList.add(class_name);
        item.id=id_name;
        item.textContent=text;
        item.style.whiteSpace = "pre";
        input.parentNode.appendChild(item);
    }

function clean_message(casella){
    var casella=document.getElementById(casella);
        if(casella)
            casella.remove();
    }

</script>
</body>
</html>
